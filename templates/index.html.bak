<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <!-- PWA -->
    <link
      rel="manifest"
      href="{{ url_for('static', filename='manifest.json') }}"
    />
    <meta name="theme-color" content="#0d6efd" />
    <link
      rel="icon"
      href="{{ url_for('static', filename='icon-192.png') }}"
      type="image/png"
    />

    <meta charset="UTF-8" />
    <title>Login</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <style>
      body {
        background: linear-gradient(135deg, #f0f2f5, #d9e4f5);
      }

      .login-card {
        max-width: 400px;
        width: 90%;
        padding: 2rem;
        border-radius: 16px;
        background-color: #fff;
      }

      .login-card input {
        height: 50px;
        font-size: 1rem;
      }

      .login-card button {
        height: 50px;
        font-size: 1rem;
      }

      .form-label {
        font-weight: 500;
      }
    </style>
  </head>
  <body class="d-flex justify-content-center align-items-center vh-100">
    <div class="login-card shadow-lg">
      <h3 class="mb-4 text-center text-primary">
        <i class="bi bi-box-arrow-in-right"></i> Acesso ao Sistema
      </h3>

      <div class="mb-3">
        <label for="email" class="form-label">E-mail</label>
        <input
          type="email"
          id="email"
          class="form-control"
          placeholder="exemplo@dominio.com"
          autocomplete="username"
        />
      </div>

      <div class="mb-3">
        <label for="senha" class="form-label">Senha</label>
        <input
          type="password"
          id="senha"
          class="form-control"
          placeholder="Digite sua senha"
          autocomplete="current-password"
        />
      </div>

      <button class="btn btn-primary w-100 mb-3" onclick="logar()">
        Entrar
      </button>

      <div class="text-center">
        <a href="/cadastro" class="text-decoration-none"
          >Criar uma nova conta</a
        >
        <div class="text-center mt-2">
  <a href="{{ url_for('auth.form_redefinir_senha') }}" class="text-decoration-none">

    Esqueci minha senha
  </a>
</div>

      </div>
    </div>
    <!-- Service Worker -->
    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("/static/service-worker.js")
          .then((reg) => console.log("✅ Service Worker registrado!", reg))
          .catch((err) =>
            console.error("❌ Erro ao registrar Service Worker", err)
          );
      }
    </script>

    <!-- Botão de instalação do app -->
    <script>
      let deferredPrompt;
      window.addEventListener("beforeinstallprompt", (e) => {
        console.log("✅ beforeinstallprompt disparado");
        e.preventDefault();
        deferredPrompt = e;
        const btn = document.getElementById("btnInstalar");
        if (btn) btn.style.display = "inline-block";
      });

      function instalarApp() {
        if (deferredPrompt) {
          deferredPrompt.prompt();
          deferredPrompt.userChoice.then(() => {
            deferredPrompt = null;
            const btn = document.getElementById("btnInstalar");
            if (btn) btn.style.display = "none";
          });
        }
      }
    </script>

    <!-- Botão (opcional) -->
    <button
      id="btnInstalar"
      onclick="instalarApp()"
      style="display: none"
      class="btn btn-outline-primary mt-3"
    >
      Instalar App
    </button>

    <script src="/static/js/login.js"></script>
  </body>
</html>
